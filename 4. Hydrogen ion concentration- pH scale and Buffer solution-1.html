<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  
  <title>4. Hydrogen ion concentration- pH scale and Buffer solution-1</title>
  
  <style>
    :root{--bg:#0f172a;--panel:#111827;--muted:#9ca3af;--text:#e5e7eb;
      --brand:#22c55e;--accent:#3b82f6;--danger:#ef4444;--amber:#f59e0b;--ring:#60a5fa;}
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,'Helvetica Neue',Arial,'Noto Sans';background:var(--bg);color:var(--text)}
    header{position:sticky;top:0;z-index:9999;background:linear-gradient(180deg,rgba(17,24,39,.95),rgba(17,24,39,.85));backdrop-filter:blur(6px);border-bottom:1px solid #1f2937}

    .wrap{max-width:1200px;margin-inline:auto;padding:14px 16px;display:flex;align-items:center;gap:12px;justify-content:space-between;}
    
    /* ‚Üì‚Üì‚Üì Smaller Logo Title ‚Üì‚Üì‚Üì */
    h1{font-size:15px;margin:0;display:flex;gap:10px;align-items:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:60vw;}
    h1 span.logo{display:inline-grid;place-items:center;width:28px;height:28px;border-radius:8px;overflow:hidden;}
    h1 span.logo img{width:100%;height:100%;object-fit:contain;}

    .controls{display:flex;gap:10px;align-items:center;flex-wrap:nowrap;}
    
    /* ‚Üì‚Üì‚Üì Smaller Buttons ‚Üì‚Üì‚Üì */
    .btn{padding:6px 10px;font-size:13px;border:1px solid #334155;border-radius:10px;background:#111827;color:var(--text);cursor:pointer;white-space:nowrap;}
    .btn:hover{border-color:#475569}
    .btn.primary{background:var(--accent);border-color:var(--accent);color:white}
    .btn.success{background:var(--brand);border-color:var(--brand);color:white}
    .btn.warn{background:var(--amber);border-color:var(--amber);color:black}
    .btn.danger{background:var(--danger);border-color:var(--danger);color:white}
    
   main{max-width:1400px;margin:18px auto;display:grid;gap:18px;padding:0 16px}

/* Default mode (Question + OMR) */
main.default {
  grid-template-columns: 4fr 1fr; /* Question : OMR */
}

/* Score mode (score panel replaces OMR only) */
main.scoreMode {
  grid-template-columns: 1fr 1fr; /* Keep it balanced */
}



   
   iframe{width:100%;height:79dvh;border:1px solid #1f2937;border-radius:14px;background:#0b1220}
    
	.panel .content{height:80dvh;overflow-y:auto;-webkit-overflow-scrolling: touch;padding:12px 14px}
    .panel{background:var(--panel);border:1px solid #1f2937;border-radius:14px}
    
	.panel h2{margin:0;padding:14px 16px;border-bottom:1px solid #1f2937;font-size:13px} /* smaller than 16px */
    .panel .content{padding:12px 14px}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:8px}
    .card{background:#0b1220;border:1px solid #1f2937;border-radius:10px;padding:6px;font-size:13px}
    .qhead{display:flex;justify-content:space-between;align-items:center;margin-bottom:4px;font-size:12px}
    .choices{display:grid;grid-template-columns:repeat(5,1fr);gap:4px}
    .choice{position:relative;}
    .choice label{display:block;text-align:center;padding:5px 0;border-radius:8px;border:1px solid #334155;background:#0b1220;color:var(--muted);font-size:12px;font-weight:500}
    .choice input{position:absolute;opacity:0;inset:0;cursor:pointer}
    .choice input:checked+label{border-color:var(--ring);box-shadow:0 0 0 2px rgba(96,165,250,.4) inset;color:#fff}
    .status{font-size:11px;color:var(--muted)}
    .scorecard{max-width:900px;margin:20px auto;background:white;color:#111;border:1px solid #e5e7eb;border-radius:12px}
    .scorecard header{position:relative;background:white;border-bottom:1px solid #e5e7eb}
    .scorecard .wrap{padding:16px}
    .score-badges{display:flex;gap:10px;flex-wrap:wrap}
    .badge{display:inline-flex;align-items:center;gap:8px;border-radius:999px;padding:6px 10px;font-weight:600;border:1px solid #e5e7eb;font-size:13px}
    .badge.win{background:#ecfdf5;color:#065f46}
    .badge.lose{background:#fef2f2;color:#991b1b}
    .badge.na{background:#fefce8;color:#92400e}
    table{width:100%;border-collapse:collapse;font-size:13px}
    th,td{border-bottom:1px solid #e5e7eb;padding:6px 8px;text-align:left}
    #omrPanel,#scorePanel,#solutionPanel{display:none;}
    main.default #omrPanel{display:block;}
    main.scoreMode #scorePanel{display:block;}
   
 main.solutionMode{
  grid-template-columns: 0.7fr 1.3fr; /* Question = 0.7 , Solution = 1.3  (ratio 0.7:1.3 = 7:13) */
}
main.solutionMode #solutionPanel{display:block;grid-column:auto;}
main.solutionMode #scorePanel{grid-column:1/-1;margin-top:20px;}

    @media (max-width:900px){
      .controls{gap:6px;}
      .btn{padding:5px 8px;font-size:12px;}
      h1{font-size:14px;max-width:55vw;}
    }
    @media (max-width:600px){
      .btn{padding:4px 7px;font-size:11px;}
      h1{font-size:13px;gap:6px;max-width:55vw;}
    }
    @media (max-width:480px){
      .btn{padding:3px 6px;font-size:10px;}
      h1{font-size:12px;max-width:45vw;}
    }
.panel h2 {
  margin: 0;
  padding: 8px 12px;   /* reduced height */
  font-size: 11px;     /* reduced font size */
}
/* Instruction Panel */
#instructionBox {
  position: fixed;
  left: 0;
  top: 50%;
  transform: translateY(-50%);
  width: 280px;
  background: #111827;
  border-right: 2px solid #1f2937;
  padding: 18px;
  color: var(--text);
  font-size: 14px;
  line-height: 1.5;
  z-index: 999999;
  border-radius: 0 12px 12px 0;
}
#instructionBox h3 {
  margin: 0 0 10px 0;
  font-size: 15px;
  color: var(--accent);
}
#instructionBox button {
  margin-top: 12px;
  width: 100%;
  padding: 8px 0;
  background: var(--brand);
  color: white;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  font-weight: 600;
  font-size: 14px;
}
#instructionBox button:hover { opacity: 0.9; }
/* MOBILE ‚Äî make instructions easy to read */
@media (max-width: 600px) {
  #instructionBox {
    top: auto;
    bottom: 0;
    width: 100%;
    transform: none;
    border-radius: 12px 12px 0 0;
    border-right: none;
    border-top: 2px solid #1f2937;
    font-size: 13px;
    text-align: center;
  }
  #instructionBox p { font-size: 13px; }
}

    #lockScreen{position:fixed;inset:0;background:var(--bg);display:flex;justify-content:center;align-items:center;z-index:99999;}
    #lockScreen .box{background:var(--panel);padding:30px;border-radius:16px;text-align:center;max-width:320px;width:100%;}
    #lockScreen input{margin:8px 0;padding:10px;width:100%;border-radius:10px;border:1px solid #374151;background:#0b1220;color:var(--text)}
  </style>
</head>
<body>

<!-- Instructions Panel -->
<div id="instructionBox">
  <h3>üìå Instructions</h3>
  <p>‚úî Enter your correct Name & Password to start the test.<br>
     ‚úî Attempt all questions carefully.<br>
     ‚úî Click <b>N</b> to lock your final answer.<br>
     ‚úî Once locked, answer can't be changed.</p>

  <!-- BUTTON to get password -->
  <button onclick="window.open('https://your-password-link.com','_blank')">
    üîë Get Your Password
  </button>
</div>







  <!-- Lock Screen -->
  <div id="lockScreen">
    <div class="box">
      <h2>Enter Password to Start Test</h2>
      <input id="studentName" type="text" placeholder="Student Name" />
      <input id="testPass" type="password" placeholder="Password" />
      <button class="btn primary" id="startBtn">Start Test</button>
      <p id="errorMsg" style="color:#ef4444;font-size:13px;display:none;">Invalid name or password</p>
    </div>
  </div>

  <header>
    <div class="wrap">
      <h1>
  <span class="logo">
    <a href="https://drive.google.com/uc?export=view&id=1-dDr5ZRq-GcFVilGEt-S9VthYwRz62Mh" target="_blank" rel="noopener">
      <img src="https://i.ibb.co/WNZTWPwv/LOGO-PNG-2025-fab.png" alt="Logo">
    </a>
  </span>
  
  4. Hydrogen ion concentration- pH scale and Buffer solution-1
  
  
  
  
  
</h1>
      <div class="controls">
        <button class="btn success" id="submitBtn">Submit & Score</button>
        <button class="btn warn" id="shareBtn" style="display:none;">Share Scorecard</button>
        <button class="btn primary" id="viewSolutionBtn" style="display:none;">View Solution</button>
        <button class="btn danger" id="reportBtn">Report</button>
      </div>
    </div>
  </header>

  <main id="mainArea" class="default" style="display:none;">
    <section class="panel" id="questionPanel">
      <h2>Question Paper</h2>
      <div class="content"><iframe id="pdfFrame"></iframe></div>
    </section>
    <section class="panel" id="omrPanel"><h2>OMR Answer Sheet</h2><div class="content"><div id="omrGrid" class="grid"></div></div></section>
    <section class="panel" id="scorePanel"><h2>Scorecard</h2><div class="content"><div id="resultArea"></div></div></section>
    <section class="panel" id="solutionPanel"><h2>Solution PDF</h2><div class="content"><iframe id="solutionFrame"></iframe></div></section>
  </main>

  <script>
    const config={
      title:'MCQ Practice Test',
      questionUrl:'https://chemistry-g10ep.github.io/IIT-JEE--M--HTML-PDF-IONIC-EQUI/4. Hydrogen ion concentration- pH scale and Buffer solution-1-Q.pdf',
      solutionUrl:'https://chemistry-g10ep.github.io/IIT-JEE--M--HTML-PDF-IONIC-EQUI/4. Hydrogen ion concentration- pH scale and Buffer solution-1-A.pdf',
      totalQuestions:20,
      startQuestion:1,
      answerKey:{1:'A',2:'C',3:'D',4:'B',5:'B',
6:'D',7:'A',8:'C',9:'B',10:'D',
11:'A',12:'D',13:'C',14:'A',15:'B',
16:'D',17:'B',18:'C',19:'C',20:'D',
21:'B',22:'C',23:'A',24:'D',25:'B',
26:'A',27:'A',28:'D',29:'B',30:'B',
31:'D',32:'B',33:'A',34:'A',35:'C',
36:'C',37:'C',38:'A',39:'A',40:'D',
41:'A',42:'A',43:'B',44:'D',45:'B',
46:'A',47:'B',48:'A',49:'C',50:'A',
51:'A',52:'C',53:'C',54:'C',55:'D',
56:'A',57:'C',58:'B',59:'B',60:'C',
61:'B',62:'C',63:'B',64:'B',65:'C',
66:'A',67:'B',68:'D',69:'A',70:'C',
71:'D',72:'A',73:'B',74:'A',75:'B',
76:'A',77:'A',78:'C',79:'B',80:'A',
81:'B',82:'C',83:'B',84:'B',85:'C',
86:'B',87:'A',88:'A',89:'A',90:'D',
91:'B',92:'C',93:'A',94:'A',95:'C',
96:'B',97:'B',98:'B',99:'B',100:'B',
101:'C',102:'C',103:'A',104:'A',105:'C',
106:'A',107:'C',108:'C',109:'D',110:'B',
111:'D',112:'D',113:'B',114:'A',115:'C',
116:'D',117:'B',118:'B',119:'D',120:'C',
121:'D',122:'B',123:'C',124:'D',125:'B',
126:'B',127:'A',128:'C',129:'B',130:'D',
131:'C',132:'D',133:'C',134:'C',135:'A',
136:'C',137:'C',138:'C',139:'C',140:'B',
141:'B',142:'A',143:'D',144:'B',145:'B',
146:'D',147:'C',148:'B',149:'A',150:'D',
151:'B',152:'D',153:'B',154:'B',155:'C',
156:'D',157:'C',158:'A',159:'C',160:'D',
161:'C',162:'D',163:'B',164:'A',165:'D',
166:'A',167:'D',168:'B',169:'C',170:'A',
171:'C',172:'C',173:'D',174:'B',175:'A',
176:'C',177:'A',178:'C',179:'A',180:'B',
181:'C',182:'B',183:'B',184:'B',185:'C',
186:'B',187:'B',188:'A',189:'A',190:'B',
191:'D',192:'B',193:'B',194:'B',195:'A',
196:'B',197:'B',198:'B',199:'A',200:'AD',
201:'AC',202:'ABC',203:'C',204:'C',205:'B',
206:'B'}
,
      marksPerCorrect:4,
      negativeMarking:1,
      password:'97063803574'
    
	
	
	};
	const lastMarked = {};
	
	
	
	
	
    const $=id=>document.getElementById(id);

    function initTest(){
      document.title=config.title;
$('pdfFrame').src =
  `https://mozilla.github.io/pdf.js/web/viewer.html?file=${encodeURIComponent(config.questionUrl)}#toolbar=0&zoom=auto`;
      renderOMR(config.totalQuestions);
    }

    function makeChoice(q,l,type){
      // input first then label so CSS "input:checked + label" works
      return `<div class="choice"><input type="${type}" name="q${q}" id="q${q}_${l}" value="${l}"><label for="q${q}_${l}">${l}</label></div>`;
    }

    function renderOMR(n){
      const g=$('omrGrid');
      g.innerHTML='';
      const L=['A','B','C','D','N']; // includes N for Not Attempted
      const start=config.startQuestion || 1;
      for(let i=0;i<n;i++){
        const q=start+i;
        const rawKey=(config.answerKey[q]||'').toString().replace(/\s+/g,'').toUpperCase();
        const keyLen = rawKey.length;
        const type = keyLen > 1 ? 'checkbox' : 'radio';
        const multiHint = keyLen > 1 ? '<span style="color:var(--amber);font-size:10px;margin-left:8px;">(Multi-correct)</span>' : '';
        g.innerHTML+=`<div class="card"><div class="qhead"><div style="display:flex;align-items:center;gap:8px"><strong>Q${q}</strong>${multiHint}</div><span class="status" id="st${q}">‚Äî</span></div><div class="choices">${L.map(l=>makeChoice(q,l,type)).join('')}</div></div>`;
      }
	  
	  
	  
	  

      // attach listeners with max-selection enforcement and N-handling
// attach listeners with max-selection enforcement and N-handling
g.querySelectorAll('input').forEach(inp=>{
  inp.addEventListener('change', () => {
    const q = parseInt(inp.name.replace('q',''),10);

    // If N is clicked and checked -> capture current selection first (before unchecking)
    if (inp.value === 'N' && inp.checked) {
      // capture current (pre-N) selected options excluding N
      const prevSel = [...document.querySelectorAll(`input[name=q${q}]`)]
                        .filter(x => x.value !== 'N' && x.checked)
                        .map(x => x.value).join('');

      // store previous selection so scorecard can still show it
      lastMarked[q] = prevSel || '';

      // now uncheck all non-N options (N remains checked)
      document.querySelectorAll(`input[name=q${q}]`).forEach(x => {
        if (x.value !== 'N') x.checked = false;
      });

      updateStatus(q);
      // pass prevSel into lock function so coloring uses the pre-N selection
      lockQuestionAndColor(q, prevSel);
      return;
    }

    // When A/B/C/D clicked ‚Üí just mark answer (no color)
    if (inp.value !== 'N' && inp.checked) {
      const nButton = document.querySelector(`#q${q}_N`);
      if (nButton) nButton.checked = false;
    }

    // store checked state in dataset for each input (useful for multi-select awareness)
    document.querySelectorAll(`input[name=q${q}]`).forEach(x => x.dataset.sel = x.checked ? "1" : "0");

    updateStatus(q); // update the mini status text
  });
});

    }






    function updateStatus(q){
      const sel=[...document.querySelectorAll(`input[name=q${q}]:checked`)].map(x=>x.value).join('');
      $(`st${q}`).textContent = sel || '‚Äî';
    }

   function getAllAnswers(){
  const arr = [];
  const start = config.startQuestion || 1;

  for(let i = 0; i < config.totalQuestions; i++){
    const q = start + i;

    let sel = [...document.querySelectorAll(`input[name=q${q}]:checked`)]
                .map(x => x.value).join('');

    // if final answer locked using N, use stored marked answer
    if (lastMarked[q] !== undefined) sel = lastMarked[q];

    arr.push({ q, ans: sel || '' });
  }

  return arr;
}





    // computeResult: scaled partial marking
    function computeResult(){
      const ans = getAllAnswers();
      let correct=0, wrong=0, na=0, score=0;
      const rows=[];

      for(const {q, ans: markRaw} of ans){
        const keyRaw = (config.answerKey[q] || '').toString().replace(/\s+/g,'').toUpperCase();
        const keySet = new Set(keyRaw.split('').filter(Boolean));
        const mark = (markRaw||'').toString().replace(/\s+/g,'').toUpperCase();

        // Not attempted or explicitly N
        if(!mark || mark === 'N'){
          na++;
          rows.push({q, sel:'-', key: keyRaw || '-', status:'NA'});
          continue;
        }

        const selSet = new Set(mark.split('').filter(Boolean));
        const correctSelCount = [...selSet].filter(x => keySet.has(x)).length;
        const wrongSelCount = [...selSet].filter(x => !keySet.has(x)).length;

        // Single-correct: full marks or full negative
        if(keySet.size === 1){
          if(correctSelCount === 1 && wrongSelCount === 0){
            correct++;
            score += config.marksPerCorrect;
            rows.push({q, sel:mark, key:keyRaw, status:'Correct'});
          } else {
            wrong++;
            score -= config.negativeMarking;
            rows.push({q, sel:mark, key:keyRaw, status:'Wrong'});
          }
          continue;
        }

        // Multi-correct:
        // perCorrect = marksPerCorrect / numberOfCorrectOptions
        // perWrong   = negativeMarking / numberOfCorrectOptions
        const numCorrectOptions = keySet.size;
        const perCorrect = config.marksPerCorrect / numCorrectOptions;
        const perWrong = config.negativeMarking / numCorrectOptions;

        // full correct selected, no wrongs
        if(correctSelCount === numCorrectOptions && wrongSelCount === 0){
          correct++;
          score += config.marksPerCorrect;
          rows.push({q, sel:mark, key:keyRaw, status:'Correct'});
          continue;
        }

        // partial / mixed selection
        if(correctSelCount > 0 || wrongSelCount > 0){
          const gained = correctSelCount * perCorrect;
          const lost = wrongSelCount * perWrong;
          const net = gained - lost; // can be negative
          if(net > 0) correct++; else wrong++;
          score += net;
          rows.push({q, sel:mark, key:keyRaw, status:`Partial (${net.toFixed(2)})`});
          continue;
        }

        // fallback (shouldn't happen)
        wrong++;
        score -= config.negativeMarking;
        rows.push({q, sel:mark, key:keyRaw, status:'Wrong'});
      }

      // round to 2 decimals
      score = Math.round(score * 100) / 100;
      return { correct, wrong, na, score, total: config.totalQuestions, rows };
    }
	
	
	
	
	
	
	
	
function lockQuestionAndColor(q, prevSel) {
  const rawKey = (config.answerKey[q] || '').trim().toUpperCase();
  const keySet = new Set(rawKey.split('').filter(Boolean));
  const inputs = document.querySelectorAll(`input[name=q${q}]`);

  // If prevSel not passed ‚Üí capture selected-before-N
  if (!prevSel) {
    prevSel = [...inputs]
      .filter(x => x.value !== 'N' && x.dataset.sel === "1")
      .map(x => x.value)
      .join('');
  }
  prevSel = prevSel.toUpperCase();

  // ‚ùó Fix scorecard blank issue
  lastMarked[q] = prevSel || '';

  inputs.forEach(inp => {
    inp.disabled = true;
    const lbl = document.querySelector(`label[for="${inp.id}"]`);

    // Reset old styles
    lbl.style.background = "#0b1220";
    lbl.style.color = "var(--muted)";
    lbl.style.border = "1px solid #334155";

    // ‚úî Correct option always green
    if (keySet.has(inp.value)) {
      lbl.style.background = "green";
      lbl.style.color = "white";
    }

    // ‚úî Wrong attempt becomes red
    if (prevSel.includes(inp.value) && !keySet.has(inp.value)) {
      lbl.style.background = "red";
      lbl.style.color = "white";
    }

    // ‚úî Correct attempt (only if student selected it) gets yellow border
    if (prevSel.includes(inp.value) && keySet.has(inp.value)) {
      lbl.style.border = "3px solid yellow";
    }
  });
}










    function buildScorecard(res){
      const percent = ((res.score / (res.total * config.marksPerCorrect)) * 100).toFixed(1);
      const stuName = $('studentName').value;
      const rowsHtml = res.rows.map(r => `<tr><td>Q${r.q}</td><td>${r.sel}</td><td>${r.key}</td><td>${r.status}</td></tr>`).join('');
      return `<article class="scorecard"><header><div class="wrap"><h2>${config.title}</h2><p><strong>${stuName}</strong></p></div></header><div class="wrap"><div class="score-badges"><span class="badge win">Score: ${res.score}</span><span class="badge win">Correct: ${res.correct}</span><span class="badge lose">Wrong: ${res.wrong}</span><span class="badge na">Not Attempted: ${res.na}</span><span class="badge">Total Marks: ${res.total*config.marksPerCorrect}</span><span class="badge">Percentage: ${percent}%</span></div></div><div class="wrap"><table><thead><tr><th>Q.No</th><th>Your Ans</th><th>Correct Ans</th><th>Status</th></tr></thead><tbody>${rowsHtml}</tbody></table></div></article>`;
    }
    
    $('submitBtn').addEventListener('click',()=>{
      const res = computeResult();
      $('resultArea').innerHTML = buildScorecard(res);
      $('viewSolutionBtn').style.display='inline-block';
      $('shareBtn').style.display='inline-block';
      $('mainArea').className='scoreMode';
    });
    
    $('viewSolutionBtn').addEventListener('click',()=>{
      $('solutionFrame').src=`https://mozilla.github.io/pdf.js/web/viewer.html?file=${encodeURIComponent(config.solutionUrl)}`;
      $('mainArea').className='solutionMode';
      if(window.innerWidth<=900){
        setTimeout(()=>{ $('solutionPanel').scrollIntoView({behavior:'smooth'}); },200);
      }
    });

    $('shareBtn').addEventListener('click',()=>{
      const res = computeResult();
      const text = `üìä ${config.title}\nüë§ ${$('studentName').value}\n‚úÖ Correct: ${res.correct}\n‚ùå Wrong: ${res.wrong}\n‚ö™ Not Attempted: ${res.na}\nüèÜ Score: ${res.score}`;
const url = `https://wa.me/918069409455?text=${encodeURIComponent(text)}`;
      window.open(url, '_blank');
      if(window.innerWidth<=900){
        setTimeout(()=>{ $('scorePanel').scrollIntoView({behavior:'smooth'}); },200);
      }
    });

    $('startBtn').addEventListener('click',()=>{
      const name = $('studentName').value.trim();
      const pass = $('testPass').value.trim();
      if(!name || pass !== config.password){ $('errorMsg').style.display='block'; return; }
      $('lockScreen').style.display='none';
      $('mainArea').style.display='grid';
      initTest();
    });

    // Report button logic
    $('reportBtn').addEventListener('click',()=>{
      const msg = prompt("Enter your report (e.g., 'Q5 solution seems wrong')");
      if(!msg) return;
      const student = $('studentName').value || "Anonymous";
      const heading = config.title;
      const encodedMsg = encodeURIComponent(`Student: ${student}\nQuiz: ${heading}\nReport: ${msg}`);
      const phone = "918069409455";
      window.open(`https://wa.me/${phone}?text=${encodedMsg}`, '_blank');
    });
	
	// ‚û§ Add this at the bottom of your script
document.getElementById("startBtn").addEventListener("click", function () {
    document.getElementById("instructionBox").style.display = "none";   // hide instructions panel
    startTest();
});

	
	
  </script>
</body>
</html>

